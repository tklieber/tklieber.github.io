# Limites de l'évaluation des vulnérabilités et des tests de pénétration

Si les missions de sécurité classiques, telles que les évaluations de vulnérabilité et les tests de pénétration, donnent un excellent aperçu de la situation technique d'une entreprise en matière de sécurité, elles peuvent négliger d'autres aspects qu'un véritable attaquant peut exploiter. En ce sens, nous pourrions dire que les tests de pénétration conventionnels sont bons pour montrer les vulnérabilités afin que vous puissiez prendre des mesures proactives, mais qu'ils ne vous apprennent pas nécessairement comment répondre à une attaque réelle en cours menée par un adversaire motivé.

## Évaluations des vulnérabilités

Il s'agit de la forme la plus simple d'évaluation de la sécurité. Son principal objectif est d'identifier le plus grand nombre de vulnérabilités dans le plus grand nombre possible de systèmes du réseau. À cette fin, des concessions peuvent être faites pour atteindre efficacement cet objectif. Par exemple, la machine de l'attaquant peut être autorisée par les solutions de sécurité disponibles afin de ne pas interférer avec le processus de découverte des vulnérabilités. Cela est logique puisque l'objectif est d'examiner chaque hôte du réseau et d'évaluer sa posture de sécurité individuellement tout en fournissant le plus d'informations possible à l'entreprise sur les points sur lesquels elle doit concentrer ses efforts de remédiation.

En résumé, une évaluation des vulnérabilités se concentre sur la recherche de vulnérabilités sur les hôtes en tant qu'entités individuelles, afin d'identifier les déficiences de sécurité et de déployer des mesures de sécurité efficaces pour protéger le réseau de manière prioritaire. La majeure partie du travail peut être effectuée à l'aide d'outils automatisés et réalisée par des opérateurs sans nécessiter de grandes connaissances techniques.

Par exemple, si vous deviez effectuer une évaluation de la vulnérabilité d'un réseau, vous essaieriez normalement d'analyser le plus grand nombre possible d'hôtes, sans toutefois essayer d'exploiter la moindre vulnérabilité :

![Untitled](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/857f751d-2ce2-472e-a1cb-32add84cf1dd/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220920T103824Z&X-Amz-Expires=86400&X-Amz-Signature=34813b123d78be28eff5fc33a2ac8c6e5638c1ef0848291f813d74625d68d630&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)

## Tests d’intrusion

En plus d'analyser chaque hôte à la recherche de vulnérabilités, nous avons souvent besoin de comprendre leur impact sur notre réseau dans son ensemble. Les tests de pénétration complètent les évaluations des vulnérabilités en permettant au pentester d'explorer l'impact d'un attaquant sur l'ensemble du réseau en effectuant des étapes supplémentaires, notamment

- Tenter d'exploiter les vulnérabilités trouvées sur chaque système. Cette étape est importante car il arrive qu'une vulnérabilité existe dans un système, mais que les contrôles compensatoires en place empêchent efficacement son exploitation. Cela nous permet également de tester si nous pouvons utiliser les vulnérabilités détectées pour compromettre un hôte donné.
- Effectuer des tâches post-exploitation sur tout hôte compromis, ce qui nous permet de voir si nous pouvons en extraire des informations utiles ou si nous pouvons les utiliser pour pivoter vers d'autres hôtes qui n'étaient pas accessibles auparavant depuis notre position.

Les tests de pénétration peuvent commencer par une analyse des vulnérabilités, tout comme une évaluation régulière des vulnérabilités, mais fournissent des informations supplémentaires sur la façon dont un attaquant peut enchaîner les vulnérabilités pour atteindre des objectifs spécifiques. S'il reste axé sur l'identification des vulnérabilités et la mise en place de mesures de protection du réseau, il considère également le réseau comme un écosystème à part entière et la manière dont un attaquant pourrait profiter des interactions entre ses composants.

Si nous devions effectuer un test de pénétration en utilisant le même exemple de réseau que précédemment, en plus de rechercher les vulnérabilités de tous les hôtes du réseau, nous essaierions de confirmer si elles peuvent être exploitées afin de montrer l'impact qu'un attaquant pourrait avoir sur le réseau :

![https://s3.us-west-2.amazonaws.com/secure.notion-static.com/a3e5e5a6-3a6a-42f4-a160-6be84033b336/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220920T103919Z&X-Amz-Expires=86400&X-Amz-Signature=6ecfe980a2d9ee6ad90aa3313604ec99c2297b546aab778f5a25d63380babec7&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/a3e5e5a6-3a6a-42f4-a160-6be84033b336/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220920T103919Z&X-Amz-Expires=86400&X-Amz-Signature=6ecfe980a2d9ee6ad90aa3313604ec99c2297b546aab778f5a25d63380babec7&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)

En analysant la façon dont un attaquant pourrait se déplacer sur notre réseau, nous obtenons également un aperçu de base sur les contournements possibles des mesures de sécurité et notre capacité à détecter un véritable acteur de la menace dans une certaine mesure, limitée parce que la portée d'un test de pénétration est généralement étendue et que les testeurs de pénétration ne se soucient pas beaucoup d'être bruyants ou de générer beaucoup d'alertes sur les dispositifs de sécurité puisque les contraintes de temps sur de tels projets nous obligent souvent à vérifier le réseau en peu de temps.

En analysant la façon dont un attaquant pourrait se déplacer sur notre réseau, nous obtenons également un aperçu de base sur les contournements possibles des mesures de sécurité et notre capacité à détecter un véritable acteur de la menace dans une certaine mesure, limitée parce que la portée d'un test de pénétration est généralement étendue et que les testeurs de pénétration ne se soucient pas beaucoup d'être bruyants ou de générer beaucoup d'alertes sur les dispositifs de sécurité puisque les contraintes de temps sur de tels projets nous obligent souvent à vérifier le réseau en peu de temps.

## Menaces persistantes avancées et pourquoi le pentesting régulier ne suffit pas

Bien que les engagements de sécurité conventionnels que nous avons mentionnés couvrent la découverte de la plupart des vulnérabilités techniques, il existe des limites à ces processus et à la mesure dans laquelle ils peuvent préparer efficacement une entreprise contre un véritable attaquant. Ces limites sont les suivantes :

![https://s3.us-west-2.amazonaws.com/secure.notion-static.com/5eb259d6-d42f-4ce0-9fdf-26c7a0d9f3ae/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220920T103948Z&X-Amz-Expires=86400&X-Amz-Signature=e2263c56388b9b3ca52510c227a82845cc52145b0826726f35528b952f3cce62&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/5eb259d6-d42f-4ce0-9fdf-26c7a0d9f3ae/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220920T103948Z&X-Amz-Expires=86400&X-Amz-Signature=e2263c56388b9b3ca52510c227a82845cc52145b0826726f35528b952f3cce62&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)

Par conséquent, certains aspects des tests de pénétration peuvent différer de manière significative d'une attaque réelle, par exemple :

Par conséquent, certains aspects des tests de pénétration peuvent différer de manière significative d'une attaque réelle, par exemple :

- Les tests de pénétration sont bruyants : en général, les pentesters ne font pas beaucoup d'efforts pour essayer de passer inaperçus. Contrairement aux attaquants réels, ils ne se soucient pas d'être faciles à détecter, car ils ont été engagés pour trouver autant de vulnérabilités que possible dans autant d'hôtes que possible.
- Les vecteurs d'attaque non techniques peuvent être négligés : Les attaques basées sur l'ingénierie sociale ou les intrusions physiques ne sont généralement pas incluses dans ce qui est testé.
- Assouplissement des mécanismes de sécurité : Lors d'un test d'intrusion régulier, certains mécanismes de sécurité peuvent être temporairement désactivés ou relâchés pour l'équipe de pentesting dans un souci d'efficacité. Bien que cela puisse sembler contre-intuitif, il est essentiel de se rappeler que les pentesters disposent d'un temps limité pour vérifier le réseau. Par conséquent, on souhaite généralement qu'ils ne perdent pas leur temps à chercher des moyens exotiques de contourner les IDS/IPS, les WAF, la tromperie d'intrusion ou d'autres mesures de sécurité, mais qu'ils se concentrent plutôt sur l'examen des infrastructures technologiques critiques à la recherche de vulnérabilités.

D'un autre côté, les véritables attaquants ne suivent pas de code éthique et sont pour la plupart libres de leurs actions. Aujourd'hui, les acteurs les plus importants en matière de menaces sont connus sous le nom de menaces persistantes avancées (APT), qui sont des groupes d'attaquants hautement qualifiés, généralement parrainés par des nations ou des groupes criminels organisés. Ils ciblent principalement les infrastructures critiques, les organisations financières et les institutions gouvernementales. Elles sont dites persistantes car les opérations de ces groupes peuvent rester indétectées sur des réseaux compromis pendant de longues périodes.

Si une entreprise est touchée par une APT, serait-elle prête à réagir efficacement ? Pourrait-elle détecter les méthodes utilisées pour obtenir et maintenir l'accès à ses réseaux si l'attaquant y est présent depuis plusieurs mois ? Et si l'accès initial a été obtenu parce que John, à la comptabilité, a ouvert une pièce jointe suspecte dans un courriel ? Et si un exploit de type "zero-day" était impliqué ? Les tests de pénétration précédents nous préparent-ils à cette éventualité ?

Pour fournir une approche plus réaliste de la sécurité, les missions Red Team sont nées.

# Engagements de la red team

Pour faire face aux menaces émergentes, les engagements de l'équipe rouge ont été conçus pour passer des tests de pénétration réguliers à un processus qui nous permet de voir clairement les capacités de notre équipe défensive à détecter et à répondre à un véritable acteur de la menace. Ils ne remplacent pas les tests de pénétration traditionnels, mais les complètent en se concentrant sur la détection et la réponse plutôt que sur la prévention.

Le red teaming est un terme emprunté à l'armée. Dans les exercices militaires, un groupe prend le rôle d'une équipe rouge pour simuler des techniques d'attaque afin de tester les capacités de réaction d'une équipe de défense, généralement appelée équipe bleue, face aux stratégies connues de l'adversaire. Transposés dans le monde de la cybersécurité, les engagements de l'équipe rouge consistent à émuler les tactiques, techniques et procédures (TTP) d'un véritable acteur de la menace afin de pouvoir mesurer la façon dont notre équipe bleue y réagit et, en fin de compte, améliorer les contrôles de sécurité en place.

Chaque engagement de l'équipe rouge commence par la définition d'objectifs clairs, souvent appelés "joyaux de la couronne" ou "drapeaux", allant de la compromission d'un hôte critique donné au vol d'informations sensibles de la cible. En général, l'équipe bleue ne sera pas informée de ces exercices pour éviter d'introduire des biais dans leur analyse. L'équipe rouge fera tout son possible pour atteindre les objectifs tout en restant indétectable et en échappant aux mécanismes de sécurité existants tels que les pare-feu, les antivirus, les EDR, les IPS et autres. Remarquez que lors d'un engagement de l'équipe rouge, les vulnérabilités de tous les hôtes d'un réseau ne sont pas vérifiées. Un véritable attaquant n'a besoin que de trouver un seul chemin vers son objectif et n'est pas intéressé à effectuer des analyses bruyantes que l'équipe bleue pourrait détecter.

En prenant le même réseau que précédemment, sur un engagement de l'équipe rouge où le but est de compromettre le serveur intranet, nous planifierions un moyen d'atteindre notre objectif en interagissant le moins possible avec les autres hôtes. Pendant ce temps, la capacité de l'équipe bleue à détecter et à répondre à l'attaque peut être évaluée :

![https://s3.us-west-2.amazonaws.com/secure.notion-static.com/043ca4a3-808a-489b-837a-4b5deb541b90/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220920T104042Z&X-Amz-Expires=86400&X-Amz-Signature=9fe13b2e58c4ac49f4d9a0cfe14519e5e284f1acbfeaa38f5270fa0e43f01b52&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/043ca4a3-808a-489b-837a-4b5deb541b90/Untitled.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Content-Sha256=UNSIGNED-PAYLOAD&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20220920%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20220920T104042Z&X-Amz-Expires=86400&X-Amz-Signature=9fe13b2e58c4ac49f4d9a0cfe14519e5e284f1acbfeaa38f5270fa0e43f01b52&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22Untitled.png%22&x-id=GetObject)

Il est important de noter que l'objectif final de ces exercices ne devrait jamais être de permettre à l'équipe rouge de "battre" l'équipe bleue, mais plutôt de simuler suffisamment de TTP pour que l'équipe bleue apprenne à réagir de manière adéquate à une menace réelle en cours. Si nécessaire, ils peuvent modifier ou ajouter des contrôles de sécurité qui contribuent à améliorer leurs capacités de détection.

Il est important de noter que l'objectif final de ces exercices ne devrait jamais être de permettre à l'équipe rouge de "battre" l'équipe bleue, mais plutôt de simuler suffisamment de TTP pour que l'équipe bleue apprenne à réagir de manière adéquate à une menace réelle en cours. Si nécessaire, ils peuvent modifier ou ajouter des contrôles de sécurité qui contribuent à améliorer leurs capacités de détection.

Il est important de noter que l'objectif final de ces exercices ne devrait jamais être de permettre à l'équipe rouge de "battre" l'équipe bleue, mais plutôt de simuler suffisamment de TTP pour que l'équipe bleue apprenne à réagir de manière adéquate à une menace réelle en cours. Si nécessaire, ils peuvent modifier ou ajouter des contrôles de sécurité qui contribuent à améliorer leurs capacités de détection.

Les engagements de l'équipe rouge améliorent également les tests de pénétration ordinaires en prenant en compte plusieurs surfaces d'attaque :

- L'infrastructure technique : Comme dans un test de pénétration ordinaire, une équipe rouge essaiera de découvrir des vulnérabilités techniques, en mettant l'accent sur la furtivité et l'évasion.
- Ingénierie sociale : Cibler des personnes par le biais de campagnes de phishing, d'appels téléphoniques ou de médias sociaux pour les inciter à révéler des informations qui devraient être privées.
- Intrusion physique : Utilisation de techniques telles que le crochetage de serrures, le clonage RFID, l'exploitation des faiblesses des dispositifs de contrôle d'accès électronique pour accéder aux zones restreintes des installations.

En fonction des ressources disponibles, l'exercice de l'équipe rouge peut se dérouler de plusieurs manières :

- Engagement complet : Simulez le flux de travail complet d'un attaquant, de la compromission initiale jusqu'à la réalisation des objectifs finaux.
- Violation présumée : Commencez par supposer que l'attaquant a déjà pris le contrôle de certains actifs, et essayez d'atteindre les objectifs à partir de là. Par exemple, l'équipe rouge pourrait avoir accès aux informations d'identification d'un utilisateur ou même à un poste de travail dans le réseau interne.
- Exercice sur table : Une simulation sur table où des scénarios sont discutés entre les équipes rouge et bleue pour évaluer comment elles répondraient théoriquement à certaines menaces. Idéal pour les situations où les simulations en direct pourraient être compliquées.


